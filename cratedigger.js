!function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return i(n?n:e)},c,c.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){(function(n){"use strict";function o(e){for(var t,n,o=e.length;o;t=parseInt(Math.random()*o),n=e[--o],e[o]=e[t],e[t]=n);return e}function i(e){return"function"==typeof e||!1}var r="undefined"!=typeof window?window.THREE:"undefined"!=typeof n?n.THREE:null,a=e("tween.js"),s=e("stats-js"),l="undefined"!=typeof window?window.Modernizr:"undefined"!=typeof n?n.Modernizr:null,u="undefined"!=typeof window?window.dat:"undefined"!=typeof n?n.dat:null;e("./threejs_modules/ShaderPass")(r),e("./threejs_modules/CopyShader")(r),e("./threejs_modules/RenderPass")(r),e("./threejs_modules/DoFShader")(r),e("./threejs_modules/FXAAShader")(r),e("./threejs_modules/MaskPass")(r),e("./threejs_modules/EffectComposer")(r);var c,f,d,h,p,m,v,g,y,w,x,b,M,C,P,E,I,S,T,D,F,z,O,A,L,B,j,R,_,k,U={},N={},X=[],W=[],H=[],Q="closed",Y=!0,G={x:0,y:0},q={x:0,y:0},V={x:0,y:0},K=-1,Z=-1,J=0,$={debug:!0,canvasWidth:null,canvasHeight:null,nbCrates:2,recordsPerCrate:24,lightIntensity:1,cameraMouseMove:!0,backgroundColor:1118481,sleeveColor:853762,sleeveMaskTexture:"img/sleeve.png",crateTexture:"img/wood.jpg",closeInfoPanelOnClick:!0,closeInfoPanelOnScroll:!0,infoPanelOpacity:.9,postprocessing:!1,blurAmount:.4,updateCanvasSizeOnWindowResize:!0,onInfoPanelOpened:function(){},onInfoPanelClosed:function(){},onLoadingEnd:function(){},elements:{rootContainerId:"cratedigger",canvasContainerId:"cratedigger-canvas",loadingContainerId:"cratedigger-loading",infoContainerId:"cratedigger-info",titleContainerId:"cratedigger-record-title",artistContainerId:"cratedigger-record-artist",coverContainerId:"cratedigger-record-cover"},constants:{recordMoveTime:1e3,cameraMoveTime:800,infoOpenTime:800,recordBaseY:5,recordShownY:25,recordFlippedY:110,targetBasePosition:{x:-20,y:10,z:0},cameraBasePosition:{x:280,y:200,z:180},cameraFocusPosition:{x:160,y:190,z:85},cameraMouseMoveSpeedY:.07,cameraMouseMoveSpeedZ:.03,grabSensitivity:6}},ee=function(e,t,n){this.id=e,this.crateId=t,this.pos=n,this.state="out",this.recordXPos=-62+135/U.recordsPerCrate*n,this.mesh=new r.Mesh(new r.BoxGeometry(100,1.5,100,1,1,1),new r.MeshFaceMaterial(Re(null,!1))),this.mesh.geometry.applyMatrix((new r.Matrix4).makeTranslation(50,0,0)),this.mesh.position.set(this.recordXPos,U.constants.recordBaseY,0),this.mesh.rotation.z=Math.PI/2,this.mesh.recordId=e,this.absolutePosition=new r.Vector3,this.setUnactive(),this.pushRecord()};ee.prototype.log=function(){console.log("Record nÂ°",this.id,"crateId =",this.crateId,"pos =",this.pos)},ee.prototype.setActive=function(){this.active=!0,this.mesh.visible=!0},ee.prototype.setUnactive=function(){this.active=!1,this.mesh.visible=!1},ee.prototype.showRecord=function(){"shown"!==this.state&&(this.state="shown",this.absolutePosition.setFromMatrixPosition(this.mesh.matrixWorld),new a.Tween(this.mesh.position).to({y:U.constants.recordShownY},U.constants.recordMoveTime).easing(a.Easing.Quartic.Out).start(),new a.Tween(this.mesh.rotation).to({z:Math.PI/2},U.constants.recordMoveTime).easing(a.Easing.Quartic.Out).start(),new a.Tween(x.position).to({x:this.recordXPos,y:50+U.constants.recordShownY,z:this.absolutePosition.z},U.constants.cameraMoveTime).easing(a.Easing.Quartic.Out).start(),new a.Tween(w.position).to({x:this.recordXPos+U.constants.cameraFocusPosition.x,y:U.constants.cameraFocusPosition.y,z:this.absolutePosition.z+U.constants.cameraFocusPosition.z},U.constants.cameraMoveTime).easing(a.Easing.Quartic.Out).start())},ee.prototype.pushRecord=function(){"pushed"!=this.state&&(this.state="pushed",new a.Tween(this.mesh.position).to({y:U.constants.recordBaseY},U.constants.recordMoveTime).easing(a.Easing.Quartic.Out).start(),new a.Tween(this.mesh.rotation).to({z:Math.PI/2+Math.PI/7},U.constants.recordMoveTime).easing(a.Easing.Quartic.Out).start())},ee.prototype.pullRecord=function(){"pulled"!==this.state&&(this.state="pulled",new a.Tween(this.mesh.position).to({y:U.constants.recordBaseY},U.constants.recordMoveTime).easing(a.Easing.Quartic.Out).start(),new a.Tween(this.mesh.rotation).to({z:Math.PI/2-Math.PI/7},U.constants.recordMoveTime).easing(a.Easing.Quartic.Out).start())},ee.prototype.flipRecord=function(e){this.state="flipped",new a.Tween(this.mesh.position).to({y:U.constants.recordFlippedY},U.constants.infoOpenTime).easing(a.Easing.Quartic.Out).start(),new a.Tween(this.mesh.rotation).delay(U.constants.infoOpenTime/4).to({y:Math.PI},U.constants.infoOpenTime).easing(a.Easing.Quartic.Out).start(),new a.Tween(x.position).to({x:this.recordXPos,y:U.constants.recordFlippedY+50,z:this.absolutePosition.z},U.constants.infoOpenTime).easing(a.Easing.Quartic.Out).start().onComplete(e),new a.Tween(w.position).to({x:this.recordXPos+U.constants.cameraFocusPosition.x+80,y:U.constants.cameraFocusPosition.y-50},U.constants.cameraMoveTime).easing(a.Easing.Quartic.Out).start()},ee.prototype.flipBackRecord=function(e,t){"flipped"===this.state&&(new a.Tween(this.mesh.position).delay(U.constants.infoOpenTime/2).to({y:U.constants.recordBaseY},U.constants.infoOpenTime).easing(a.Easing.Quartic.Out).start(),new a.Tween(this.mesh.rotation).to({y:0},U.constants.infoOpenTime/2).easing(a.Easing.Quartic.Out).start().onComplete(e),t||(new a.Tween(x.position).delay(U.constants.infoOpenTime/2).to({x:this.recordXPos,y:75,z:this.absolutePosition.z},U.constants.infoOpenTime).easing(a.Easing.Quartic.Out).start(),new a.Tween(w.position).to({x:this.recordXPos+U.constants.cameraFocusPosition.x,y:U.constants.cameraFocusPosition.y},U.constants.cameraMoveTime).easing(a.Easing.Quartic.Out).start()))};var te=function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},ne=function(){Y&&(requestAnimationFrame(ne),oe(),U.debug&&g.update())},oe=function(){a.update(),ce(),U.cameraMouseMove&&(V.x=.25*(G.x/B-.5),V.y=.25*(G.y/B-.5),A.rotation.y+=U.constants.cameraMouseMoveSpeedY*(V.x-A.rotation.y),A.rotation.z+=U.constants.cameraMouseMoveSpeedZ*(V.y-A.rotation.z)),w.lookAt(x.position),U.postprocessing?(y.overrideMaterial=O,b.render(y,w,D),y.overrideMaterial=null,E.render()):b.render(y,w)},ie=function(){for(var e=0;e<W.length;e++)W[e].data=null,W[e].setUnactive();J=0,H=[]},re=function(e,t,n){fe(!0),Ie(function(){J>0&&ie(),t&&(e=o(e));for(var i=0;i<W.length&&i<e.length;i++)W[i].data=e[i],W[i].setActive(),W[i].mesh.material.materials=Re(e[i].cover,e[i].hasSleeve);J=W.length,H=e,setTimeout(function(){Se(d),U.onLoadingEnd(),n&&n()},2e3)})},ae=function(){var e=H;e=o(e),re(e)},se=function(e){"opened"===Q?ue():"opening"!==Q&&"closing"!==Q&&(K=e)},le=function(){W[K]&&(ye(W[K]),Q="opening",W[K].flipRecord(function(){Q="opened"}),U.onInfoPanelOpened(),setTimeout(function(){Ne(h,U.infoPanelOpacity)},300))},ue=function(e){"opened"===Q&&(Ue(h),Q="closing",W[K].flipBackRecord(function(){Q="closed",U.onInfoPanelClosed()},e))},ce=function(){if("closed"===Q&&Z!=K){Z=K;for(var e=0;J>e;e++)-1==K?W[e].pushRecord():e>K&&e>W[K].crateId*U.recordsPerCrate&&e<W[K].crateId*U.recordsPerCrate+U.recordsPerCrate?W[e].pullRecord():e==K?W[e].showRecord():W[e].pushRecord()}},fe=function(e){"opened"!==Q||e?"opening"!==Q&&"closing"!==Q&&("opened"===Q&&ue(!0),K=-1,new a.Tween(x.position).to({x:U.constants.targetBasePosition.x,y:U.constants.targetBasePosition.y,z:U.constants.targetBasePosition.z},U.constants.cameraMoveTime).easing(a.Easing.Quartic.Out).start(),new a.Tween(w.position).to({x:U.constants.cameraBasePosition.x,y:U.constants.cameraBasePosition.y,z:U.constants.cameraBasePosition.z},U.constants.cameraMoveTime).easing(a.Easing.Quartic.Out).start()):ue()},de=function(){se(pe(K))},he=function(){se(me(K))},pe=function(e){return-1==e?e=J-1:J-1>e?e+=1:e=0,W[e].active?e:pe(e)},me=function(e){return-1==e?e=J-1:e>0?e-=1:e=J-1,W[e].active?e:me(e)},ve=function(e){"closed"===Q?"prev"===e?de():he():"opened"===Q&&U.closeInfoPanelOnScroll&&ue()},ge=function(e,t){t=!t||Math.abs(t)>.5?.5:Math.abs(t);var n=1-t,o=n*n*n*300;_=setTimeout(function(){b.domElement.classList.add("grab");var t=(e-G.y)/j;t>0?he():0>t&&de(),ge(e,t)},o)},ye=function(e){e.data.title&&(p.innerHTML=e.data.title),e.data.artist&&(m.innerHTML=e.data.artist),e.data.cover&&(v.style.backgroundImage="url("+e.data.cover+")")},we=function(e){var t=0,n=0,o=0,i=0,r=this;if(e||(e=window.event),e.pageX||e.pageY?(t=e.pageX,n=e.pageY):(e.clientX||e.clientY)&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),r.offsetParent)do o+=r.offsetLeft,i+=r.offsetTop;while(r=r.offsetParent);G.x=t-o,G.y=n-i},xe=function(e){return ve(_e(e)<0?"prev":"next"),!1},be=function(e){if("closed"===Q){var t={x:(e.x-b.domElement.offsetLeft)/b.domElement.width*2-1,y:2*-((e.y-b.domElement.offsetTop)/b.domElement.height)+1,z:.5},n=new r.Vector3(t.x,t.y,t.z);n.unproject(w);var o=new r.Raycaster(w.position,n.sub(w.position).normalize()),i=o.intersectObjects(L.children,!0);if(i.length>0){for(var a,s=0;s<i.length&&"undefined"!=typeof i[s].object.recordId;s++)if(i[s].object.visible&&i[s].object.recordId>=0){a=W[i[s].object.recordId];break}a?K===a.id?le():se(a.id):fe()}else fe()}},Me=function(e){clearInterval(_),"closed"===Q?(ge(G.y),q={x:G.x,y:G.y}):"opened"===Q&&U.closeInfoPanelOnClick&&ue()},Ce=function(e){clearInterval(_),b.domElement.classList.remove("grab"),ke(q,G,U.constants.grabSensitivity)&&be(q)},Pe=function(e){37===e.keyCode||38===e.keyCode?ve("next"):(39===e.keyCode||40===e.keyCode)&&ve("prev")},Ee=function(e){Xe(),We(),b.setSize(B,j),w.aspect=B/j,w.updateProjectionMatrix(),S.uniforms.tDepth.value=D,S.uniforms.size.value.set(B,j),S.uniforms.textel.value.set(1/B,1/j),I.uniforms.resolution.value.set(1/B,1/j)},Ie=function(e){Ne(d,1,e)},Se=function(e){Ue(d,e)},Te=function(){y=new r.Scene,b=new r.WebGLRenderer({antialias:!0}),b.setSize(B,j),f.appendChild(b.domElement),b.domElement.id="context",b.setClearColor(U.backgroundColor,1),w=new r.PerspectiveCamera(45,B/j,.1,2e4),w.focalLength=45,w.frameSize=32,w.setLens(w.focalLength,w.frameSize),x=new r.Object3D,w.lookAt(x.position);var e=r.ImageUtils.loadTexture(U.crateTexture);e.anisotropy=b.getMaxAnisotropy(),k=new r.MeshLambertMaterial({map:e}),A=new r.Object3D,L=new r.Object3D,y.add(A),A.add(L),Ae(),Be(),M=new r.PointLight(16777215,1.1*U.lightIntensity),M.position.set(300,80,0),y.add(M),C=new r.PointLight(16777215,.6*U.lightIntensity),C.position.set(-100,300,1e3),y.add(C),P=new r.PointLight(16777215,.6*U.lightIntensity),P.position.set(-100,300,-1e3),y.add(P),De(),c.addEventListener("DOMMouseScroll",xe,!1),c.addEventListener("mousewheel",xe,!1),c.addEventListener("mousemove",we,!1),c.addEventListener("mousedown",Me,!1),c.addEventListener("mouseup",Ce,!1),window.addEventListener("keydown",Pe,!1),U.updateCanvasSizeOnWindowResize&&window.addEventListener("resize",Ee,!1),c.style.position="relative",f.style.position="absolute",h.style.position="absolute",d.style.position="absolute",We(),h.style.display="none",U.debug&&(Fe(),ze()),fe(),ne()},De=function(){F=r.ShaderLib.depthRGBA,z=r.UniformsUtils.clone(F.uniforms),O=new r.ShaderMaterial({fragmentShader:F.fragmentShader,vertexShader:F.vertexShader,uniforms:z}),O.blending=r.NoBlending,D=new r.WebGLRenderTarget(B,j,{minFilter:r.NearestFilter,magFilter:r.NearestFilter,format:r.RGBAFormat}),E=new r.EffectComposer(b),E.addPass(new r.RenderPass(y,w)),S=new r.ShaderPass(r.DoFShader),S.uniforms.tDepth.value=D,S.uniforms.size.value.set(B,j),S.uniforms.textel.value.set(1/B,1/j),S.uniforms.znear.value=w.near,S.uniforms.zfar.value=w.far,S.uniforms.focalDepth.value=5,S.uniforms.focalLength.value=w.focalLength,S.uniforms.fstop.value=8,S.uniforms.showFocus.value=!1,S.uniforms.manualdof.value=!0,S.uniforms.ndofstart.value=11,S.uniforms.ndofdist.value=80,S.uniforms.fdofstart.value=0,S.uniforms.fdofdist.value=100,S.uniforms.CoC.value=.03,S.uniforms.vignetting.value=!1,S.uniforms.autofocus.value=!0,S.uniforms.focus.value.set(.35,.35),S.uniforms.maxblur.value=U.blurAmount,S.uniforms.threshold.value=0,S.uniforms.gain.value=0,S.uniforms.bias.value=0,S.uniforms.fringe.value=0,I=new r.ShaderPass(r.FXAAShader),I.uniforms.resolution.value.set(1/B,1/j),I.renderToScreen=!0,E.addPass(S),E.addPass(I)},Fe=function(){g=new s,g.domElement.style.position="absolute",g.domElement.style.left="0",g.domElement.style.top="0",c.appendChild(g.domElement);var e=new r.Mesh(new r.BoxGeometry(20,20,20,1,1,1));e.position.set(M.position.x,M.position.y,M.position.z),y.add(e)},ze=function(){var e,t,n;T=new u.GUI,U.postprocessing&&(e=T.addFolder("Camera"),t=e.add(w,"focalLength",28,200).name("Focal Length"),t.onChange(Oe),n=T.addFolder("Depth of Field"),n.add(S.uniforms.focalDepth,"value",0,10).name("Focal Depth"),n.add(S.uniforms.fstop,"value",0,22).name("F Stop"),n.add(S.uniforms.maxblur,"value",0,3).name("max blur"),n.add(S.uniforms.showFocus,"value").name("Show Focal Range"),n.add(S.uniforms.manualdof,"value").name("Manual DoF"),n.add(S.uniforms.ndofstart,"value",0,200).name("near start"),n.add(S.uniforms.ndofdist,"value",0,200).name("near falloff"),n.add(S.uniforms.fdofstart,"value",0,200).name("far start"),n.add(S.uniforms.fdofdist,"value",0,200).name("far falloff"),n.add(S.uniforms.CoC,"value",0,.1).step(.001).name("circle of confusion"),n.add(S.uniforms.vignetting,"value").name("Vignetting"),n.add(S.uniforms.vignout,"value",0,2).name("outer border"),n.add(S.uniforms.vignin,"value",0,1).step(.01).name("inner border"),n.add(S.uniforms.vignfade,"value",0,22).name("fade at"),n.add(S.uniforms.autofocus,"value").name("Autofocus"),n.add(S.uniforms.focus.value,"x",0,1).name("focus x"),n.add(S.uniforms.focus.value,"y",0,1).name("focus y"),n.add(S.uniforms.threshold,"value",0,1).step(.01).name("threshold"),n.add(S.uniforms.gain,"value",0,100).name("gain"),n.add(S.uniforms.bias,"value",0,4).step(.01).name("bias"),n.add(S.uniforms.fringe,"value",0,5).step(.01).name("fringe"),n.add(S.uniforms.noise,"value").name("Use Noise"),n.add(S.uniforms.namount,"value",0,.001).step(1e-4).name("dither"),n.add(S.uniforms.depthblur,"value").name("Blur Depth"),n.add(S.uniforms.dbsize,"value",0,5).name("blur size")),T.close()},Oe=function(){w.setLens(w.focalLength,w.frameSize),w.updateProjectionMatrix(),S.uniforms.focalLength.value=w.focalLength},Ae=function(){for(var e=0;e<U.nbCrates;e++){var t=Le(e);L.add(t)}L.position.z=-(110-110*U.nbCrates)/2},Le=function(e){X[e]=new r.Object3D;var t=new r.Mesh(new r.BoxGeometry(200,10,100),k);X[e].add(t);var n=new r.Mesh(new r.BoxGeometry(200,10,80),k);if(n.position.set(0,35,-55),n.rotation.x=Math.PI/2,X[e].add(n),0===e){var o=new r.Mesh(new r.BoxGeometry(200,10,80),k);o.position.set(0,35,55),o.rotation.x=Math.PI/2,X[e].add(o)}var i=new r.Mesh(new r.BoxGeometry(80,10,120),k);i.position.set(-105,35,0),i.rotation.z=Math.PI/2,X[e].add(i);var a=new r.Mesh(new r.BoxGeometry(40,10,100),k);return a.position.set(95,25,0),a.rotation.z=Math.PI/2,X[e].add(a),X[e].position.z=-110*e,X[e]},Be=function(){for(var e=0,t=0;t<X.length;t++)for(var n=0;n<U.recordsPerCrate;n++)je(e,t,n),e++},je=function(e,t,n){var o=new ee(e,t,n);X[t].add(o.mesh),W.push(o)},Re=function(e,t){var n=new Image;n.crossOrigin="Anonymous",n.src=e?e:"";var o=400,i=400,a=document.createElement("canvas");a.width=a.height=400;var s=new r.Texture(a);s.minFilter=r.LinearFilter,n.onload=function(){if(t){var e=new Image;e.src=U.sleeveMaskTexture,e.onload=function(){var t=a.getContext("2d");t.translate(o/2,i/2),t.rotate(Math.PI/2),t.translate(-o/2,-i/2),t.drawImage(n,130,130,135,135),t.drawImage(e,0,0,400,400),s.needsUpdate=!0}}else{var r=a.getContext("2d");r.translate(o/2,i/2),r.rotate(Math.PI/2),r.translate(-o/2,-i/2),r.drawImage(n,0,0,400,400),s.needsUpdate=!0}};var l=new r.MeshLambertMaterial({color:U.sleeveColor}),u=[l,l,l,new r.MeshLambertMaterial({color:16777215,map:s}),l,l];return u},_e=function(e){return e||(e=event),e.detail<0?1:e.wheelDelta>0?1:-1},ke=function(e,t,n){return Math.abs(e.x-t.x)<=n&&Math.abs(e.y-t.y)<=n},Ue=function(e,t){e.style.opacity<=.1?(e.style.display="none",e.style.opacity=0,i(t)&&t()):(e.style.opacity-=.1,setTimeout(function(){Ue(e,t)},10))},Ne=function(e,t,n,o){!e.style.opacity||e.style.opacity&&e.style.opacity<t?("none"==e.style.display?(e.style.display="block",o=0):e.style.display||(o=e.style.opacity||1),o+=.03,e.style.opacity=o,setTimeout(function(){Ne(e,t,n,o)},10)):(e.style.opacity=t,i(n)&&n())},Xe=function(){B=U.canvasWidth?U.canvasWidth:c.clientWidth,j=U.canvasHeight?U.canvasHeight:c.clientHeight},We=function(){f.style.height=j+"px",h.style.height=j+"px",d.style.height=j+"px",f.style.width=B+"px",h.style.width=B+"px",d.style.width=B+"px"};N.init=function(e){if(U=te($,e),l.webgl){if(R=void 0!==window.devicePixelRatio?window.devicePixelRatio:1,c=document.getElementById(U.elements.rootContainerId),!c)return void console.error("cratedigger.js - Init failed : can not find root container element.");if(f=document.getElementById(U.elements.canvasContainerId),!f)return void console.error("cratedigger.js - Init failed : can not find canvas container element.");if(d=document.getElementById(U.elements.loadingContainerId),!d)return void console.error("cratedigger.js - Init failed : can not find loading container element.");if(h=document.getElementById(U.elements.infoContainerId),!h)return void console.error("cratedigger.js - Init failed : can not find info container element.");if(p=document.getElementById(U.elements.titleContainerId),!p)return void console.error("cratedigger.js - Init failed : can not find record title container element.");if(m=document.getElementById(U.elements.artistContainerId),!m)return void console.error("cratedigger.js - Init failed : can not find record artist container element.");if(v=document.getElementById(U.elements.coverContainerId),!v)return void console.error("cratedigger.js - Init failed : can not find cover image container element.");Xe(),Te()}},N.selectRecord=function(e){0>e?fe():K=e>J?J-1:e},N.startRender=function(){Y=!0,ne()},N.stopRender=function(){Y=!1},N.enablePostprocessing=function(){U.postprocessing=!0},N.disablePostprocessing=function(){U.postprocessing=!1},N.getCanvas=function(){return b.domElement},N.getRecordsDataList=function(){return H},N.getLoadedRecords=function(){return J},N.getSelectedRecord=function(){return W[K]},N.loadRecords=re,N.unloadRecords=ie,N.resetShownRecord=fe,N.shuffleRecords=ae,N.flipSelectedRecord=le,N.selectPrevRecord=de,N.selectNextRecord=he,N.showLoading=Ie,N.hideLoading=Se,t.exports=N}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./threejs_modules/CopyShader":4,"./threejs_modules/DoFShader":5,"./threejs_modules/EffectComposer":6,"./threejs_modules/FXAAShader":7,"./threejs_modules/MaskPass":8,"./threejs_modules/RenderPass":9,"./threejs_modules/ShaderPass":10,"stats-js":2,"tween.js":3}],2:[function(e,t,n){var o=function(){var e=Date.now(),t=e,n=0,o=1/0,i=0,r=0,a=1/0,s=0,l=0,u=0,c=document.createElement("div");c.id="stats",c.addEventListener("mousedown",function(e){e.preventDefault(),y(++u%2)},!1),c.style.cssText="width:80px;opacity:0.9;cursor:pointer";var f=document.createElement("div");f.id="fps",f.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",c.appendChild(f);var d=document.createElement("div");d.id="fpsText",d.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",d.innerHTML="FPS",f.appendChild(d);var h=document.createElement("div");for(h.id="fpsGraph",h.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",f.appendChild(h);74>h.children.length;){var p=document.createElement("span");p.style.cssText="width:1px;height:30px;float:left;background-color:#113",h.appendChild(p)}var m=document.createElement("div");m.id="ms",m.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",c.appendChild(m);var v=document.createElement("div");v.id="msText",v.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",v.innerHTML="MS",m.appendChild(v);var g=document.createElement("div");for(g.id="msGraph",g.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",m.appendChild(g);74>g.children.length;)p=document.createElement("span"),p.style.cssText="width:1px;height:30px;float:left;background-color:#131",g.appendChild(p);var y=function(e){switch(u=e){case 0:f.style.display="block",m.style.display="none";break;case 1:f.style.display="none",m.style.display="block"}};return{REVISION:12,domElement:c,setMode:y,begin:function(){e=Date.now()},end:function(){var u=Date.now();n=u-e,o=Math.min(o,n),i=Math.max(i,n),v.textContent=n+" MS ("+o+"-"+i+")";var c=Math.min(30,30-30*(n/200));return g.appendChild(g.firstChild).style.height=c+"px",l++,u>t+1e3&&(r=Math.round(1e3*l/(u-t)),a=Math.min(a,r),s=Math.max(s,r),d.textContent=r+" FPS ("+a+"-"+s+")",c=Math.min(30,30-30*(r/100)),h.appendChild(h.firstChild).style.height=c+"px",t=u,l=0),u},update:function(){e=this.end()}}};"object"==typeof t&&(t.exports=o)},{}],3:[function(e,t,n){void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});var o=o||function(){var e=[];return{REVISION:"14",getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)},update:function(t){if(0===e.length)return!1;var n=0;for(t=void 0!==t?t:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();n<e.length;)e[n].update(t)?n++:e.splice(n,1);return!0}}}();o.Tween=function(e){var t=e,n={},i={},r={},a=1e3,s=0,l=!1,u=!1,c=!1,f=0,d=null,h=o.Easing.Linear.None,p=o.Interpolation.Linear,m=[],v=null,g=!1,y=null,w=null,x=null;for(var b in e)n[b]=parseFloat(e[b],10);this.to=function(e,t){return void 0!==t&&(a=t),i=e,this},this.start=function(e){o.add(this),u=!0,g=!1,d=void 0!==e?e:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),d+=f;for(var a in i){if(i[a]instanceof Array){if(0===i[a].length)continue;i[a]=[t[a]].concat(i[a])}n[a]=t[a],n[a]instanceof Array==!1&&(n[a]*=1),r[a]=n[a]||0}return this},this.stop=function(){return u?(o.remove(this),u=!1,null!==x&&x.call(t),this.stopChainedTweens(),this):this},this.stopChainedTweens=function(){for(var e=0,t=m.length;t>e;e++)m[e].stop()},this.delay=function(e){return f=e,this},this.repeat=function(e){return s=e,this},this.yoyo=function(e){return l=e,this},this.easing=function(e){return h=e,this},this.interpolation=function(e){return p=e,this},this.chain=function(){return m=arguments,this},this.onStart=function(e){return v=e,this},this.onUpdate=function(e){return y=e,this},this.onComplete=function(e){return w=e,this},this.onStop=function(e){return x=e,this},this.update=function(e){var o;if(d>e)return!0;g===!1&&(null!==v&&v.call(t),g=!0);var u=(e-d)/a;u=u>1?1:u;var x=h(u);for(o in i){var b=n[o]||0,M=i[o];M instanceof Array?t[o]=p(M,x):("string"==typeof M&&(M=b+parseFloat(M,10)),"number"==typeof M&&(t[o]=b+(M-b)*x))}if(null!==y&&y.call(t,x),1==u){if(s>0){isFinite(s)&&s--;for(o in r){if("string"==typeof i[o]&&(r[o]=r[o]+parseFloat(i[o],10)),l){var C=r[o];r[o]=i[o],i[o]=C}n[o]=r[o]}return l&&(c=!c),d=e+f,!0}null!==w&&w.call(t);for(var P=0,E=m.length;E>P;P++)m[P].start(e);return!1}return!0}},o.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,n=.1,o=.4;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=o/4):t=o*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(e-=1))*Math.sin(2*(e-t)*Math.PI/o)))},Out:function(e){var t,n=.1,o=.4;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=o/4):t=o*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin(2*(e-t)*Math.PI/o)+1)},InOut:function(e){var t,n=.1,o=.4;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=o/4):t=o*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?-.5*n*Math.pow(2,10*(e-=1))*Math.sin(2*(e-t)*Math.PI/o):n*Math.pow(2,-10*(e-=1))*Math.sin(2*(e-t)*Math.PI/o)*.5+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-o.Easing.Bounce.Out(1-e)},Out:function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return.5>e?.5*o.Easing.Bounce.In(2*e):.5*o.Easing.Bounce.Out(2*e-1)+.5}}},o.Interpolation={Linear:function(e,t){var n=e.length-1,i=n*t,r=Math.floor(i),a=o.Interpolation.Utils.Linear;return 0>t?a(e[0],e[1],i):t>1?a(e[n],e[n-1],n-i):a(e[r],e[r+1>n?n:r+1],i-r)},Bezier:function(e,t){var n,i=0,r=e.length-1,a=Math.pow,s=o.Interpolation.Utils.Bernstein;for(n=0;r>=n;n++)i+=a(1-t,r-n)*a(t,n)*e[n]*s(r,n);return i},CatmullRom:function(e,t){var n=e.length-1,i=n*t,r=Math.floor(i),a=o.Interpolation.Utils.CatmullRom;return e[0]===e[n]?(0>t&&(r=Math.floor(i=n*(1+t))),a(e[(r-1+n)%n],e[r],e[(r+1)%n],e[(r+2)%n],i-r)):0>t?e[0]-(a(e[0],e[0],e[1],e[1],-i)-e[0]):t>1?e[n]-(a(e[n],e[n],e[n-1],e[n-1],i-n)-e[n]):a(e[r?r-1:0],e[r],e[r+1>n?n:r+1],e[r+2>n?n:r+2],i-r)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=o.Interpolation.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n,o=1;if(e[t])return e[t];for(n=t;n>1;n--)o*=n;return e[t]=o}}(),CatmullRom:function(e,t,n,o,i){var r=.5*(n-e),a=.5*(o-t),s=i*i,l=i*s;return(2*t-2*n+r+a)*l+(-3*t+3*n-2*r-a)*s+r*i+t}}},t.exports=o},{}],4:[function(e,t,n){t.exports=function(e){e.CopyShader={uniforms:{tDiffuse:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")}}},{}],5:[function(e,t,n){t.exports=function(e){e.DoFShader={uniforms:{tDiffuse:{type:"t",value:null},tDepth:{type:"t",value:null},znear:{type:"f",value:1},zfar:{type:"f",value:1e3},size:{type:"v2",value:new e.Vector2(512,512)},textel:{type:"v2",value:new e.Vector2(1/512,1/512)},focalDepth:{type:"f",value:200},focalLength:{type:"f",value:28},fstop:{type:"f",value:2.8},showFocus:{type:"i",value:0},manualdof:{type:"i",value:0},ndofstart:{type:"f",value:1},ndofdist:{type:"f",value:2},fdofstart:{type:"f",value:1},fdofdist:{type:"f",value:3},CoC:{type:"f",value:.03},vignetting:{type:"i",value:1},vignout:{type:"f",value:1.3},vignin:{type:"f",value:0},vignfade:{type:"f",value:22},autofocus:{type:"i",value:1},focus:{type:"v2",value:new e.Vector2(.5,.5)},maxblur:{type:"f",value:1},threshold:{type:"f",value:.8},gain:{type:"f",value:1.7},bias:{type:"f",value:.5},fringe:{type:"f",value:.7},noise:{type:"i",value:1},namount:{type:"f",value:1e-4},depthblur:{type:"i",value:0},dbsize:{type:"f",value:1.25}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","#define PI  3.14159265","varying vec2 vUv;","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","uniform vec2 size;","uniform vec2 texel;","uniform float focalDepth;","uniform float focalLength;","uniform float fstop;","uniform bool showFocus;","uniform float znear;","uniform float zfar;","uniform bool manualdof;","uniform float ndofstart;","uniform float ndofdist;","uniform float fdofstart;","uniform float fdofdist;","uniform float CoC;","uniform bool vignetting;","uniform float vignout;","uniform float vignin;","uniform float vignfade;","uniform bool autofocus;","uniform vec2 focus;","uniform float maxblur;","uniform float threshold;","uniform float gain;","uniform float bias;","uniform float fringe;","uniform bool noise;","uniform float namount;","uniform bool depthblur;","uniform float dbsize;","int samples = 3;","const int rings = 3;","bool pentagon = false;","float feather = 0.4;","float unpackDepth( const in vec4 rgba_depth ) {","const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );","float depth = dot( rgba_depth, bit_shift );","return depth;","}","float penta(vec2 coords)","{","float scale = float(rings) - 1.3;","vec4  HS0 = vec4( 1.0,         0.0,         0.0,  1.0);","vec4  HS1 = vec4( 0.309016994, 0.951056516, 0.0,  1.0);","vec4  HS2 = vec4(-0.809016994, 0.587785252, 0.0,  1.0);","vec4  HS3 = vec4(-0.809016994,-0.587785252, 0.0,  1.0);","vec4  HS4 = vec4( 0.309016994,-0.951056516, 0.0,  1.0);","vec4  HS5 = vec4( 0.0        ,0.0         , 1.0,  1.0);","vec4  one = vec4( 1.0 );","vec4 P = vec4((coords),vec2(scale, scale));","vec4 dist = vec4(0.0);","float inorout = -4.0;","dist.x = dot( P, HS0 );","dist.y = dot( P, HS1 );","dist.z = dot( P, HS2 );","dist.w = dot( P, HS3 );","dist = smoothstep( -feather, feather, dist );","inorout += dot( dist, one );","dist.x = dot( P, HS4 );","dist.y = HS5.w - abs( P.z );","dist = smoothstep( -feather, feather, dist );","inorout += dist.x;","return clamp( inorout, 0.0, 1.0 );","}","float bdepth(vec2 coords) //blurring depth","{","float d = 0.0;","float kernel[9];","vec2 offset[9];","vec2 wh = vec2(texel.x, texel.y) * dbsize;","offset[0] = vec2(-wh.x,-wh.y);","offset[1] = vec2( 0.0, -wh.y);","offset[2] = vec2( wh.x -wh.y);","offset[3] = vec2(-wh.x,  0.0);","offset[4] = vec2( 0.0,   0.0);","offset[5] = vec2( wh.x,  0.0);","offset[6] = vec2(-wh.x, wh.y);","offset[7] = vec2( 0.0,  wh.y);","offset[8] = vec2( wh.x, wh.y);","kernel[0] = 1.0/16.0;   kernel[1] = 2.0/16.0;   kernel[2] = 1.0/16.0;","kernel[3] = 2.0/16.0;   kernel[4] = 4.0/16.0;   kernel[5] = 2.0/16.0;","kernel[6] = 1.0/16.0;   kernel[7] = 2.0/16.0;   kernel[8] = 1.0/16.0;","for( int i=0; i<9; i++ )","{","float tmp = unpackDepth(texture2D(tDepth, coords + offset[i]));","d += tmp * kernel[i];","}","return d;","}","vec3 color(vec2 coords,float blur)","{","vec3 col = vec3(0.0);","col.r = texture2D(tDiffuse,coords + vec2(0.0,1.0)*texel*fringe*blur).r;","col.g = texture2D(tDiffuse,coords + vec2(-0.866,-0.5)*texel*fringe*blur).g;","col.b = texture2D(tDiffuse,coords + vec2(0.866,-0.5)*texel*fringe*blur).b;","vec3 lumcoeff = vec3(0.299,0.587,0.114);","float lum = dot(col.rgb, lumcoeff);","float thresh = max((lum-threshold)*gain, 0.0);","return col+mix(vec3(0.0),col,thresh*blur);","}","vec2 rand(vec2 coord) //generating noise/pattern texture for dithering","{","float noiseX = ((fract(1.0-coord.s*(size.x/2.0))*0.25)+(fract(coord.t*(size.y/2.0))*0.75))*2.0-1.0;","float noiseY = ((fract(1.0-coord.s*(size.x/2.0))*0.75)+(fract(coord.t*(size.y/2.0))*0.25))*2.0-1.0;","if (noise)","{","noiseX = clamp(fract(sin(dot(coord ,vec2(12.9898,78.233))) * 43758.5453),0.0,1.0)*2.0-1.0;","noiseY = clamp(fract(sin(dot(coord ,vec2(12.9898,78.233)*2.0)) * 43758.5453),0.0,1.0)*2.0-1.0;","}","return vec2(noiseX,noiseY);","}","vec3 debugFocus(vec3 col, float blur, float depth)","{","float edge = 0.002*depth; //distance based edge smoothing","float m = clamp(smoothstep(0.0,edge,blur),0.0,1.0);","float e = clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);","col = mix(col,vec3(1.0,0.5,0.0),(1.0-m)*0.6);","col = mix(col,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);","return col;","}","float linearize(float depth)","{","return -zfar * znear / (depth * (zfar - znear) - zfar);","}","float vignette()","{","float dist = distance(vUv, vec2(0.5,0.5));","dist = smoothstep(vignout+(fstop/vignfade), vignin+(fstop/vignfade), dist);","return clamp(dist,0.0,1.0);","}","void main()","{","float depth = linearize(unpackDepth(texture2D(tDepth,vUv)));","if (depthblur)","{","depth = linearize(bdepth(vUv));","}","float fDepth = focalDepth;","if (autofocus)","{","fDepth = linearize(unpackDepth(texture2D(tDepth,focus)));","}","float blur = 0.0;","if (manualdof)","{","float a = depth-fDepth;","float b = (a-fdofstart)/fdofdist;","float c = (-a-ndofstart)/ndofdist;","blur = (a>0.0)?b:c;","}","else","{","float f = focalLength;","float d = fDepth*1000.0;","float o = depth*1000.0;","float a = (o*f)/(o-f);","float b = (d*f)/(d-f);","float c = (d-f)/(d*fstop*CoC);","blur = abs(a-b)*c;","}","blur = clamp(blur,0.0,1.0);","vec2 noise = rand(vUv)*namount*blur;","float w = (1.0/size.x)*blur*maxblur+noise.x;","float h = (1.0/size.y)*blur*maxblur+noise.y;","vec3 col = vec3(0.0);","if(blur < 0.05)","{","col = texture2D(tDiffuse, vUv).rgb;","}","else","{","col = texture2D(tDiffuse, vUv).rgb;","float s = 1.0;","for (int i = 1; i <= rings; i += 1)","{","float ringsamples = float(i * samples);","if(i == 1)","{","for (int j = 0 ; j < 3 ; j += 1)","{","float step = PI*2.0 / float(ringsamples);","float pw = (cos(float(j)*step)*float(i));","float ph = (sin(float(j)*step)*float(i));","float p = 1.0;","if (pentagon)","{","p = penta(vec2(pw,ph));","}","col += color(vUv + vec2(pw*w,ph*h),blur)*mix(1.0,(float(i))/(float(rings)),bias)*p;","s += 1.0*mix(1.0,(float(i))/(float(rings)),bias)*p;","}","}","else if(i == 2)","{","for (int j = 0 ; j < 6 ; j += 1)","{","float step = PI*2.0 / float(ringsamples);","float pw = (cos(float(j)*step)*float(i));","float ph = (sin(float(j)*step)*float(i));","float p = 1.0;","if (pentagon)","{","p = penta(vec2(pw,ph));","}","col += color(vUv + vec2(pw*w,ph*h),blur)*mix(1.0,(float(i))/(float(rings)),bias)*p;","s += 1.0*mix(1.0,(float(i))/(float(rings)),bias)*p;","}","}","else if(i == 3)","{","for (int j = 0 ; j < 9 ; j += 1)","{","float step = PI*2.0 / float(ringsamples);","float pw = (cos(float(j)*step)*float(i));","float ph = (sin(float(j)*step)*float(i));","float p = 1.0;","if (pentagon)","{","p = penta(vec2(pw,ph));","}","col += color(vUv + vec2(pw*w,ph*h),blur)*mix(1.0,(float(i))/(float(rings)),bias)*p;","s += 1.0*mix(1.0,(float(i))/(float(rings)),bias)*p;","}","}","}","col /= s;","}","if (showFocus)","{","col = debugFocus(col, blur, depth);","}","if (vignetting)","{","col *= vignette();","}","gl_FragColor.rgb = col;","gl_FragColor.a = 1.0;","}"].join("\n")
}}},{}],6:[function(e,t,n){t.exports=function(e){e.EffectComposer=function(t,n){if(this.renderer=t,void 0===n){var o=window.innerWidth||1,i=window.innerHeight||1,r={minFilter:e.LinearFilter,magFilter:e.LinearFilter,format:e.RGBFormat,stencilBuffer:!1};n=new e.WebGLRenderTarget(o,i,r)}this.renderTarget1=n,this.renderTarget2=n.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===e.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),this.copyPass=new e.ShaderPass(e.CopyShader)},e.EffectComposer.prototype={swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e)},insertPass:function(e,t){this.passes.splice(t,0,e)},render:function(t){this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2;var n,o,i=!1,r=this.passes.length;for(o=0;r>o;o++)if(n=this.passes[o],n.enabled){if(n.render(this.renderer,this.writeBuffer,this.readBuffer,t,i),n.needsSwap){if(i){var a=this.renderer.context;a.stencilFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),a.stencilFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}n instanceof e.MaskPass?i=!0:n instanceof e.ClearMaskPass&&(i=!1)}},reset:function(e){void 0===e&&(e=this.renderTarget1.clone(),e.width=window.innerWidth,e.height=window.innerHeight),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){var n=this.renderTarget1.clone();n.width=e,n.height=t,this.reset(n)}}}},{}],7:[function(e,t,n){t.exports=function(e){e.FXAAShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new e.Vector2(1/1024,1/512)}},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","#define FXAA_REDUCE_MIN   (1.0/128.0)","#define FXAA_REDUCE_MUL   (1.0/8.0)","#define FXAA_SPAN_MAX     8.0","void main() {","vec3 rgbNW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ).xyz;","vec3 rgbNE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ).xyz;","vec3 rgbSW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ).xyz;","vec3 rgbSE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ).xyz;","vec4 rgbaM  = texture2D( tDiffuse,  gl_FragCoord.xy  * resolution );","vec3 rgbM  = rgbaM.xyz;","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float lumaNW = dot( rgbNW, luma );","float lumaNE = dot( rgbNE, luma );","float lumaSW = dot( rgbSW, luma );","float lumaSE = dot( rgbSE, luma );","float lumaM  = dot( rgbM,  luma );","float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );","float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );","vec2 dir;","dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));","dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));","float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );","float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );","dir = min( vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX),","max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),","dir * rcpDirMin)) * resolution;","vec4 rgbA = (1.0/2.0) * (","texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (1.0/3.0 - 0.5)) +","texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (2.0/3.0 - 0.5)));","vec4 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * (","texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (0.0/3.0 - 0.5)) +","texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (3.0/3.0 - 0.5)));","float lumaB = dot(rgbB, vec4(luma, 0.0));","if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) ) {","gl_FragColor = rgbA;","} else {","gl_FragColor = rgbB;","}","}"].join("\n")}}},{}],8:[function(e,t,n){t.exports=function(e){e.MaskPass=function(e,t){this.scene=e,this.camera=t,this.enabled=!0,this.clear=!0,this.needsSwap=!1,this.inverse=!1},e.MaskPass.prototype={render:function(e,t,n,o){var i=e.context;i.colorMask(!1,!1,!1,!1),i.depthMask(!1);var r,a;this.inverse?(r=0,a=1):(r=1,a=0),i.enable(i.STENCIL_TEST),i.stencilOp(i.REPLACE,i.REPLACE,i.REPLACE),i.stencilFunc(i.ALWAYS,r,4294967295),i.clearStencil(a),e.render(this.scene,this.camera,n,this.clear),e.render(this.scene,this.camera,t,this.clear),i.colorMask(!0,!0,!0,!0),i.depthMask(!0),i.stencilFunc(i.EQUAL,1,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}},e.ClearMaskPass=function(){this.enabled=!0},e.ClearMaskPass.prototype={render:function(e,t,n,o){var i=e.context;i.disable(i.STENCIL_TEST)}}}},{}],9:[function(e,t,n){t.exports=function(e){e.RenderPass=function(t,n,o,i,r){this.scene=t,this.camera=n,this.overrideMaterial=o,this.clearColor=i,this.clearAlpha=void 0!==r?r:1,this.oldClearColor=new e.Color,this.oldClearAlpha=1,this.enabled=!0,this.clear=!0,this.needsSwap=!1},e.RenderPass.prototype={render:function(e,t,n,o){this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),e.render(this.scene,this.camera,n,this.clear),this.clearColor&&e.setClearColor(this.oldClearColor,this.oldClearAlpha),this.scene.overrideMaterial=null}}}},{}],10:[function(e,t,n){t.exports=function(e){e.ShaderPass=function(t,n){this.textureID=void 0!==n?n:"tDiffuse",this.uniforms=e.UniformsUtils.clone(t.uniforms),this.material=new e.ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.renderToScreen=!1,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.camera=new e.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new e.Scene,this.quad=new e.Mesh(new e.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},e.ShaderPass.prototype={render:function(e,t,n,o){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n),this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}}}},{}]},{},[1]);